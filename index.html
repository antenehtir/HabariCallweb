<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Habari Call Center Registry</title>
  <link rel="stylesheet" href="style.css?v=1.0.5">
  <!-- Include jsPDF and html2canvas for PDF export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <!-- Include html-docx-js and FileSaver.js for Word export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html-docx-js/0.4.1/html-docx.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <script src="script.js?v=1.0.5"></script>
  <!-- Prevent caching -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
</head>
<body>
  <div class="container">
    <!-- Logo -->
    <img src="https://play-lh.googleusercontent.com/2Yg_EcEcjUcXghSoEMH16h5Qfg54kcdmIdzmOp-cIKyPP9WIseHzNud2r681OvX3rQ=w240-h480-rw" class="logo" alt="HabariDOC Logo">
    <h1 class="title">Habari Call Center Registry</h1>
    
    <!-- Call Log Form -->
    <form id="callLogForm">
      <div class="form-group">
        <label for="phoneNumber">Phone Number</label>
        <input type="tel" id="phoneNumber" required>
      </div>
      <div class="form-group">
        <label for="date">Date</label>
        <input type="date" id="date" required>
      </div>
      <div class="form-group">
        <label for="time">Time</label>
        <input type="time" id="time" required>
      </div>
      <div class="form-group">
        <label for="callerName">Caller Name</label>
        <input type="text" id="callerName" required>
      </div>
      <div class="form-group">
        <label for="age">Age</label>
        <input type="number" id="age" required>
      </div>
      <div class="form-group">
        <label for="sex">Sex</label>
        <select id="sex" required>
          <option value="">Select Sex</option>
          <option value="Male">Male</option>
          <option value="Female">Female</option>
          <option value="Other">Other</option>
        </select>
      </div>
      <div class="form-group">
        <label for="location">Location</label>
        <input type="text" id="location" required>
      </div>
      <div class="form-group">
        <label for="representative">Representative Name (if any)</label>
        <input type="text" id="representative">
      </div>
      <div class="form-group">
        <label for="serviceProvided">Service Provided</label>
        <select id="serviceProvided">
          <option value="">Select Service</option>
          <option value="Consultation">Consultation</option>
          <option value="Follow-Up">Follow-Up</option>
          <option value="Emergency">Emergency</option>
          <option value="Other">Other</option>
        </select>
        <input type="text" id="serviceOther" placeholder="Please specify" style="display:none; margin-top: 8px;">
      </div>
      <div class="form-group">
        <label for="referral">Referral Made</label>
        <select id="referral">
          <option value="">Select</option>
          <option value="Yes">Yes</option>
          <option value="No">No</option>
        </select>
      </div>
      <div class="form-group" id="referralSiteGroup">
        <label for="referralSite">Referral Site</label>
        <input type="text" id="referralSite">
      </div>
      <div class="form-group">
        <label for="consultant">Consultant Physician</label>
        <input type="text" id="consultant">
      </div>
      <div class="form-group full-width">
        <label for="summary">Call Summary/Outcome</label>
        <textarea id="summary" rows="3" required></textarea>
      </div>
      <!-- New Field: Call Center Agent Name (placed below summary) -->
      <div class="form-group full-width">
        <label for="agentName">Call Center Agent Name</label>
        <input type="text" id="agentName" required>
      </div>
      <!-- New Field: Call Modality (placed below agent name) -->
      <div class="form-group full-width">
        <label for="callModality">Call Modality</label>
        <input type="text" id="callModality" required>
      </div>
      <div class="form-group full-width" style="text-align: center;">
        <button type="submit">Add Entry</button>
      </div>
    </form>
    
    <!-- Export Options -->
    <div class="export-buttons">
      <button type="button" onclick="exportToExcel()">Export to Excel</button>
      <button type="button" onclick="exportToPDF()">Export to PDF</button>
      <button type="button" onclick="exportToWord()">Export to Word</button>
    </div>
    
    <!-- Call Log Table -->
    <h2 class="table-title">Call Log Entries</h2>
    <div class="table-container">
      <table id="callLogTable">
        <thead>
          <tr>
            <th>Phone</th>
            <th>Date</th>
            <th>Time</th>
            <th>Caller</th>
            <th>Age</th>
            <th>Sex</th>
            <th>Location</th>
            <th>Representative</th>
            <th>Service</th>
            <th>Referral</th>
            <th>Referral Site</th>
            <th>Consultant</th>
            <th>Summary</th>
            <th>Agent Name</th>
            <th>Call Modality</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <!-- Entries appended here dynamically -->
        </tbody>
      </table>
    </div>
  </div>
  
  <script src="script.js"></script>
</body>
</html>
